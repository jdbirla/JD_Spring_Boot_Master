## Java Brains
- src: https://www.youtube.com/results?search_query=spring+security+in+spring+boot
- Github: src: https://github.com/koushikkothagal/spring-boot-security/tree/master/src/main/java/io/javabrains/springbootsecurity
- JPA: https://github.com/koushikkothagal/spring-security-jpa
- JWT:https://github.com/koushikkothagal/spring-security-jwt

![image](https://user-images.githubusercontent.com/69948118/179373350-658da467-2556-4669-b297-a5c225bbacfc.png)
![image](https://user-images.githubusercontent.com/69948118/179373355-cdcc8393-8863-422d-a469-b59bba39269a.png)
![image](https://user-images.githubusercontent.com/69948118/179373388-db8b1c11-dc5f-4f35-8b90-c4d3e53bfd6c.png)
![image](https://user-images.githubusercontent.com/69948118/179373394-01da91dd-b7f4-487c-b78a-b57d49fad231.png)
![image](https://user-images.githubusercontent.com/69948118/179373406-8d84d2cb-9267-48db-9dea-1bfabba04de8.png)
![image](https://user-images.githubusercontent.com/69948118/179373419-8c1bbdb9-4277-4fb3-980b-b1604a164968.png)
![image](https://user-images.githubusercontent.com/69948118/179373426-da57d4e3-6c3d-4e77-85ac-73b43138a1bc.png)
![image](https://user-images.githubusercontent.com/69948118/179373465-ee087a69-da9e-4b74-971b-d53df8732cbd.png)
![image](https://user-images.githubusercontent.com/69948118/179373479-96e9f54f-4fa1-4b8d-8b63-dcb4bf2c133e.png)

![image](https://user-images.githubusercontent.com/69948118/179373536-e53cb04d-bb0d-42cd-8567-91069b01e3ea.png)
![image](https://user-images.githubusercontent.com/69948118/179373542-679e5a09-348a-469b-8c11-dd498746e65e.png)
![image](https://user-images.githubusercontent.com/69948118/179373555-6a3e3656-e7e3-4f8b-b4bd-1d211eb6bc6a.png)
![image](https://user-images.githubusercontent.com/69948118/179373564-85a0e71c-2122-4f12-90a6-6de618b084c8.png)
![image](https://user-images.githubusercontent.com/69948118/179373566-c44e6c70-2b35-4a34-80f3-4fdbd331e10c.png)
![image](https://user-images.githubusercontent.com/69948118/179373584-2e0227b9-7812-41cd-a637-6652627178ff.png)
![image](https://user-images.githubusercontent.com/69948118/179373588-993101b7-dc27-4516-ae58-31bd879e43d5.png)
![image](https://user-images.githubusercontent.com/69948118/179373598-3521183f-94ee-48cb-8cd2-8c0c7b69c66c.png)
![image](https://user-images.githubusercontent.com/69948118/179373602-b249b934-e077-4e2f-a46c-558cb2f49a03.png)
![image](https://user-images.githubusercontent.com/69948118/179373612-33e0b6ad-0541-49e7-ba2c-11ec934b9766.png)
![image](https://user-images.githubusercontent.com/69948118/179373619-1e5f3c4b-7192-42a5-9e0c-99a8c39cbbce.png)
![image](https://user-images.githubusercontent.com/69948118/179373634-f3bd3a66-0507-4da2-a9ec-367395a56634.png)
![image](https://user-images.githubusercontent.com/69948118/179373648-91973b9e-d1d1-4408-8ecd-ebfa6cda4eaf.png)
![image](https://user-images.githubusercontent.com/69948118/179373649-76ae07f5-83c8-46eb-aa14-2630a7c8aeb9.png)
![image](https://user-images.githubusercontent.com/69948118/179373661-6ac2bcde-ae68-41d0-bb2d-673fbc41dfa8.png)
![image](https://user-images.githubusercontent.com/69948118/179373666-d5454a3a-f41d-49da-aa7c-7562ffbe6704.png)
![image](https://user-images.githubusercontent.com/69948118/179373670-b77194f0-4589-4f82-acc7-2519e47e8618.png)
![image](https://user-images.githubusercontent.com/69948118/179373676-6b55125e-9a5d-47a7-b033-39ba97847be4.png)
### Adding Spring Secutry to new spring boot project
![image](https://user-images.githubusercontent.com/69948118/179373716-7871a3a8-2732-414d-9afc-de1055dc8aa2.png)
![image](https://user-images.githubusercontent.com/69948118/179373722-3db1b017-04a3-46d9-9e59-87b49391e3e5.png)
![image](https://user-images.githubusercontent.com/69948118/179373739-41fea297-5e9c-4003-913e-4ed9bb3d83c9.png)
![image](https://user-images.githubusercontent.com/69948118/179373755-847e74e4-9f4a-4fbb-992b-0fa351422365.png)
![image](https://user-images.githubusercontent.com/69948118/179373784-81f0d968-9ae8-4903-80c5-f5397f0f470e.png)
![image](https://user-images.githubusercontent.com/69948118/179373815-47ab853b-1681-470c-96c3-0cdcb7af5078.png)
![image](https://user-images.githubusercontent.com/69948118/179373852-9914db39-96e9-4635-8ae8-19558e8436f3.png)
![image](https://user-images.githubusercontent.com/69948118/179373886-15c91993-0654-4266-9157-7b172ac47686.png)
### How to configure spring security authentication
![image](https://user-images.githubusercontent.com/69948118/179373913-28dcc4fe-0858-4cb3-9a33-e4afc9a5a12d.png)
![image](https://user-images.githubusercontent.com/69948118/179373921-466d463d-c179-4a1e-9484-7f92c88645bf.png)
![image](https://user-images.githubusercontent.com/69948118/179373939-bea9aa01-c463-4940-8267-60637ba1331b.png)
![image](https://user-images.githubusercontent.com/69948118/179373970-e2a9e534-a36a-4554-b559-b6c9fa433c29.png)
![image](https://user-images.githubusercontent.com/69948118/179373979-21c2c78f-383d-4eee-9ce9-1611d0af26a0.png)
![image](https://user-images.githubusercontent.com/69948118/179373986-e6d8ff41-7c70-4566-a06b-2afe100d81cb.png)
![image](https://user-images.githubusercontent.com/69948118/179374010-587c9c33-7b4d-4955-b46d-0bbf1a5a6740.png)
![image](https://user-images.githubusercontent.com/69948118/179374151-df108ae7-0193-48c1-8082-d852d65cdc2f.png)
![image](https://user-images.githubusercontent.com/69948118/179374231-1750e27f-7982-4791-9863-26d449b520eb.png)
![image](https://user-images.githubusercontent.com/69948118/179374240-cdd6294f-29ea-44d1-b792-25c4f7f0c99a.png)
### How to configure spring security authorization
![image](https://user-images.githubusercontent.com/69948118/179374323-4a740989-14f1-4f1c-8159-beec06a00835.png)
![image](https://user-images.githubusercontent.com/69948118/179374339-efe6cfe2-207d-4774-8326-0a206f322639.png)
![image](https://user-images.githubusercontent.com/69948118/179374365-47028f1b-6267-4d44-899a-77132c749dcb.png)
![image](https://user-images.githubusercontent.com/69948118/179374380-d2bac45e-9d8f-40a5-b808-e206255dc2cd.png)
![image](https://user-images.githubusercontent.com/69948118/179374438-9abd3358-d5ea-4bdb-895b-c47d73369a97.png)
![image](https://user-images.githubusercontent.com/69948118/179374441-1409ee68-f8b4-4f25-8324-9afb2a66797e.png)
![image](https://user-images.githubusercontent.com/69948118/179374624-1eac1e0f-55c4-4c5b-9903-94082c66e04f.png)


#### src/main/java/io/javabrains/springbootsecurity/HomeResource.java
```java
package io.javabrains.springbootsecurity;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HomeResource {

    @GetMapping("/")
    public String home() {
        return ("<h1>Welcome</h1>");
    }

    @GetMapping("/user")
    public String user() {
        return ("<h1>Welcome User</h1>");
    }

    @GetMapping("/admin")
    public String admin() {
        return ("<h1>Welcome Admin</h1>");
    }
}
```
#### src/main/java/io/javabrains/springbootsecurity/SecurityConfiguration.java
```java
package io.javabrains.springbootsecurity;

import org.springframework.context.annotation.Bean;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.crypto.password.NoOpPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;

@EnableWebSecurity
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {
    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        // Set your configuration on the auth object
        auth.inMemoryAuthentication()
                .withUser("blah")
                .password("blah")
                .roles("USER")
                .and()
                .withUser("foo")
                .password("foo")
                .roles("ADMIN");
    }

    @Bean
    public PasswordEncoder getPasswordEncoder() {
        return NoOpPasswordEncoder.getInstance();
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
                .antMatchers("/admin").hasRole("ADMIN")
                .antMatchers("/user").hasAnyRole("ADMIN", "USER")
                .antMatchers("/").permitAll()
                .and().formLogin();
    }
}
```
### How Spring security works
![image](https://user-images.githubusercontent.com/69948118/179374905-e80ce0f7-7a37-412e-8667-5e0faf942785.png)
![image](https://user-images.githubusercontent.com/69948118/179374925-76608058-7b86-4a34-9134-514f22b3ba86.png)
![image](https://user-images.githubusercontent.com/69948118/179374949-ef3f0fee-54a6-43e7-befb-ed9572d76719.png)
![image](https://user-images.githubusercontent.com/69948118/179374963-f3b3ec4d-b84a-4535-83bc-5976f18f4deb.png)
![image](https://user-images.githubusercontent.com/69948118/179375041-c353542d-cf7b-4355-b48c-88bc5ba0d8a0.png)
![image](https://user-images.githubusercontent.com/69948118/179375051-e597f242-e3ab-4633-a461-c2cce6542cca.png)
![image](https://user-images.githubusercontent.com/69948118/179375059-f3141a80-ea17-4cf0-879d-84134f3b0d56.png)
![image](https://user-images.githubusercontent.com/69948118/179375075-457babac-7212-44ed-a290-db94eb745d98.png)
![image](https://user-images.githubusercontent.com/69948118/179375084-ab733b05-90e2-4fba-8719-163fdbfbe794.png)
![image](https://user-images.githubusercontent.com/69948118/179375097-27933f5f-8ce8-425b-b443-2d1589cf40c6.png)
![image](https://user-images.githubusercontent.com/69948118/179375137-6fb9edc4-66ed-4f5d-8d2b-05122ae577bb.png)
![image](https://user-images.githubusercontent.com/69948118/179375165-9e975ec0-8ba3-4133-a217-3b09e4a87c79.png)
![image](https://user-images.githubusercontent.com/69948118/179375178-ef5b69f6-4e2a-4793-9947-acdf67485376.png)
![image](https://user-images.githubusercontent.com/69948118/179375182-25853337-9d2e-4f62-aa84-2aad997b0a7e.png)
![image](https://user-images.githubusercontent.com/69948118/179375214-6118fa14-ec53-43fb-aee6-6e4abcbe9fcb.png)
![image](https://user-images.githubusercontent.com/69948118/179375229-b1154601-4e42-4062-b1d2-fbe9cbbec3f5.png)
![image](https://user-images.githubusercontent.com/69948118/179375234-1169d68c-4f4c-42a5-aade-87494e41d4c6.png)
![image](https://user-images.githubusercontent.com/69948118/179375262-df37ae01-3714-4d91-bb5c-16d7966e0782.png)

### JDBC Authentication 
![image](https://user-images.githubusercontent.com/69948118/179375292-43d4a94b-e212-4ede-9367-58a7d305eb10.png)
![image](https://user-images.githubusercontent.com/69948118/179375359-b3cfe9ad-ab33-4c3c-9467-7a652aa6bd4b.png)
![image](https://user-images.githubusercontent.com/69948118/179375699-0481bbbc-090d-42d5-9271-9b0b4648b075.png)
![image](https://user-images.githubusercontent.com/69948118/179375701-d7ad7225-f51a-43bc-9a16-fa8afc5ac3b1.png)
![image](https://user-images.githubusercontent.com/69948118/179375871-3aaef171-f5d0-4854-a6b3-1b2ad8fdeef3.png)
![image](https://user-images.githubusercontent.com/69948118/179375892-1cd008fc-c5e9-48af-b647-e5815d62a098.png)
![image](https://user-images.githubusercontent.com/69948118/179375918-a8d83111-0ea7-4795-a60b-37f077d92e4e.png)
![image](https://user-images.githubusercontent.com/69948118/179376219-a615eb39-95f2-49d8-b409-e1f05b0609f2.png)
![image](https://user-images.githubusercontent.com/69948118/179376558-4adb581e-2feb-4c14-8a55-577106e495f2.png)

### Spring Boot + Spring Security + JPA authentication and MySql

![image](https://user-images.githubusercontent.com/69948118/179377461-c2ed9bdd-8731-49c6-bc71-ded0058c63c9.png)
![image](https://user-images.githubusercontent.com/69948118/179377511-9e38b46f-68c7-49a8-b18f-8d6af5e01c42.png)
![image](https://user-images.githubusercontent.com/69948118/179377989-a806c5c6-7a7f-4e12-809b-0d8f9527cba2.png)
![image](https://user-images.githubusercontent.com/69948118/179378934-f1f9e7d4-f768-4d1d-85fe-39df89e7865b.png)
![image](https://user-images.githubusercontent.com/69948118/179379227-11b6c0a1-27fd-427f-aef8-805b7ea54a26.png)
![image](https://user-images.githubusercontent.com/69948118/179379429-d85722ab-9fd0-4f04-ad7e-bda7638a5692.png)
![image](https://user-images.githubusercontent.com/69948118/179379432-f590bad9-a39c-4b26-aac7-b2890f9c8e19.png)

#### /src/main/resources/application.properties
```properties
spring.datasource.url=jdbc:mysql://localhost:3306/springsecurity
spring.datasource.username=root
spring.datasource.password =password
spring.jpa.hibernate.ddl-auto=update
spring.jpa.hibernate.naming-strategy=org.hibernate.cfg.ImprovedNamingStrategy
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5Dialect
```
#### src/main/java/io/javabrains/springsecurityjpa/models/MyUserDetails.java

```java
package io.javabrains.springsecurityjpa.models;

import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;

import java.util.Arrays;
import java.util.Collection;
import java.util.List;
import java.util.stream.Collectors;

public class MyUserDetails implements UserDetails {

    private String userName;
    private String password;
    private boolean active;
    private List<GrantedAuthority> authorities;

    public MyUserDetails(User user) {
        this.userName = user.getUserName();
        this.password = user.getPassword();
        this.active = user.isActive();
        this.authorities = Arrays.stream(user.getRoles().split(","))
                    .map(SimpleGrantedAuthority::new)
                    .collect(Collectors.toList());
    }

    @Override
    public Collection<? extends GrantedAuthority> getAuthorities() {
        return authorities;
    }

    @Override
    public String getPassword() {
        return password;
    }

    @Override
    public String getUsername() {
        return userName;
    }

    @Override
    public boolean isAccountNonExpired() {
        return true;
    }

    @Override
    public boolean isAccountNonLocked() {
        return true;
    }

    @Override
    public boolean isCredentialsNonExpired() {
        return true;
    }

    @Override
    public boolean isEnabled() {
        return active;
    }
}
```
#### /src/main/java/io/javabrains/springsecurityjpa/models/User.java 

```java
package io.javabrains.springsecurityjpa.models;

import javax.persistence.*;

@Entity
@Table(name = "User")
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private int id;
    private String userName;
    private String password;
    private boolean active;
    private String roles;

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public boolean isActive() {
        return active;
    }

    public void setActive(boolean active) {
        this.active = active;
    }

    public String getRoles() {
        return roles;
    }

    public void setRoles(String roles) {
        this.roles = roles;
    }
}
```
#### /src/main/java/io/javabrains/springsecurityjpa/HomeResource.java 

```java
package io.javabrains.springsecurityjpa;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HomeResource {

    @GetMapping("/")
    public String home() {
        return ("<h1>Welcome</h1>");
    }

    @GetMapping("/user")
    public String user() {
        return ("<h1>Welcome User</h1>");
    }

    @GetMapping("/admin")
    public String admin() {
        return ("<h1>Welcome Admin</h1>");
    }
}

```
#### /src/main/java/io/javabrains/springsecurityjpa/MyUserDetailsService.java 

```java
package io.javabrains.springsecurityjpa;

import io.javabrains.springsecurityjpa.models.MyUserDetails;

import io.javabrains.springsecurityjpa.models.User;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class MyUserDetailsService implements UserDetailsService {

    @Autowired
    UserRepository userRepository;

    @Override
    public UserDetails loadUserByUsername(String userName) throws UsernameNotFoundException {
        Optional<User> user = userRepository.findByUserName(userName);

        user.orElseThrow(() -> new UsernameNotFoundException("Not found: " + userName));

        return user.map(MyUserDetails::new).get();
    }
}
```

### /src/main/java/io/javabrains/springsecurityjpa/SecurityConfiguration.java
```java
package io.javabrains.springsecurityjpa;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.password.NoOpPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;

@EnableWebSecurity
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

    @Autowired
    UserDetailsService userDetailsService;

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth.userDetailsService(userDetailsService);
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
                .antMatchers("/admin").hasRole("ADMIN")
                .antMatchers("/user").hasAnyRole("ADMIN", "USER")
                .antMatchers("/").permitAll()
                .and().formLogin();
    }

    @Bean
    public PasswordEncoder getPasswordEncoder() {
        return NoOpPasswordEncoder.getInstance();
    }
}
```

### /src/main/java/io/javabrains/springsecurityjpa/UserRepository.java 
```java
package io.javabrains.springsecurityjpa;

import io.javabrains.springsecurityjpa.models.User;
import org.springframework.data.jpa.repository.JpaRepository;

import java.util.Optional;

public interface UserRepository extends JpaRepository<User, Integer> {
    Optional<User> findByUserName(String userName);
}
```

### /src/main/java/io/javabrains/springsecurityjpa/SpringSecurityJpaApplication.java
```java
package io.javabrains.springsecurityjpa;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;

@SpringBootApplication
@EnableJpaRepositories(basePackageClasses = UserRepository.class)
public class SpringSecurityJpaApplication {

	public static void main(String[] args) {
		SpringApplication.run(SpringSecurityJpaApplication.class, args);
	}

}
```
### Spring Boot + Spring Security + LDAP
![image](https://user-images.githubusercontent.com/69948118/179380011-8b2910fa-6ef8-41c8-9ef5-ff8ba511b870.png)
![image](https://user-images.githubusercontent.com/69948118/179380056-f3c6522e-4b27-4429-b4c6-87abc5232e05.png)
![image](https://user-images.githubusercontent.com/69948118/179380107-30788769-d20b-407c-96c1-3e0faed1d68a.png)
![image](https://user-images.githubusercontent.com/69948118/179380222-88589a3c-ed14-4b18-b1e3-01544d6e6d64.png)
![image](https://user-images.githubusercontent.com/69948118/179380189-027cc59e-208e-4a81-b26b-29759e38eb0f.png)
![image](https://user-images.githubusercontent.com/69948118/179380347-08bc5bcb-7696-4eff-a369-8db535aba0dd.png)
![image](https://user-images.githubusercontent.com/69948118/179380387-28406651-54b7-4698-bcca-445513a7ed33.png)
![image](https://user-images.githubusercontent.com/69948118/179380381-fe54381f-5fc8-4b7f-bf45-c8b364c36a45.png)

### JWT for microservices
![image](https://user-images.githubusercontent.com/69948118/179380402-8f0ec34d-d24e-4d75-a743-87652d759f66.png)
![image](https://user-images.githubusercontent.com/69948118/179380419-dd42d25a-1a95-4a0b-8315-3d1050cc858a.png)
![image](https://user-images.githubusercontent.com/69948118/179380443-adfec1bb-e182-4acc-95e6-3f07952f9289.png)
![image](https://user-images.githubusercontent.com/69948118/179380478-62cb7fd2-b5a7-46f1-ad65-12d9c472f96a.png)
![image](https://user-images.githubusercontent.com/69948118/179380480-aadbd6d8-a6f2-487a-affb-8881c65bd819.png)
![image](https://user-images.githubusercontent.com/69948118/179380484-2862b050-1f2f-4edc-a4d1-b421c03557d5.png)
![image](https://user-images.githubusercontent.com/69948118/179380488-a4d6cebf-da9d-4431-95dd-78fc9d0325b7.png)
![image](https://user-images.githubusercontent.com/69948118/179380495-11b7c73f-da73-4593-bdfb-009a3bf48869.png)
![image](https://user-images.githubusercontent.com/69948118/179380500-134338c1-8f08-4071-9679-f5eae28ad1ea.png)
![image](https://user-images.githubusercontent.com/69948118/179380524-6c196670-f16f-4962-a1d8-b892b19a713b.png)
![image](https://user-images.githubusercontent.com/69948118/179380534-71258593-d2c5-432b-9541-2fe4e775eb8c.png)
![image](https://user-images.githubusercontent.com/69948118/179380545-5825a111-7c8b-496d-852e-d96f49ce52f4.png)
![image](https://user-images.githubusercontent.com/69948118/179380561-ee220c78-3748-4c7b-b6d1-8ecf82894896.png)
![image](https://user-images.githubusercontent.com/69948118/179380566-727dc607-020f-44b9-b120-ae97389fbe42.png)
![image](https://user-images.githubusercontent.com/69948118/179380570-b850398f-0fab-460b-a529-f71cfbe49be8.png)
![image](https://user-images.githubusercontent.com/69948118/179380574-1063387f-f364-48f3-b444-3719043086fd.png)
![image](https://user-images.githubusercontent.com/69948118/179380589-bc780e0a-8aff-4fbf-823b-b6e0384e941a.png)
![image](https://user-images.githubusercontent.com/69948118/179380591-0cc76968-0b44-4c99-a1b1-dbdd5b8148a6.png)
![image](https://user-images.githubusercontent.com/69948118/179380594-dacbf68f-a842-4bb8-bd87-d0dfa6f7847e.png)
![image](https://user-images.githubusercontent.com/69948118/179380598-d06cdad7-af61-4fed-be28-14d052b09ec0.png)
![image](https://user-images.githubusercontent.com/69948118/179380608-cdc586c1-3e35-4c09-8359-309a3c102007.png)
![image](https://user-images.githubusercontent.com/69948118/179380620-32f5e17a-6428-478a-a9b0-464cab0f5b57.png)
![image](https://user-images.githubusercontent.com/69948118/179380623-d4dfbe6f-1ef1-409b-80ec-721c46b1a1c4.png)
![image](https://user-images.githubusercontent.com/69948118/179380646-820f473b-01a2-44d4-b4bc-204ad44ef07e.png)
![image](https://user-images.githubusercontent.com/69948118/179380656-dae442e1-bcb9-475c-93e6-1d9eb0413c34.png)
![image](https://user-images.githubusercontent.com/69948118/179380668-6ed49dbe-eba1-4736-8efb-7f7eccc8b515.png)
![image](https://user-images.githubusercontent.com/69948118/179380679-91a87e7a-8d55-4a42-919f-2186068bd673.png)
![image](https://user-images.githubusercontent.com/69948118/179380692-905bd4d7-958a-4036-9104-960e94f5f715.png)
![image](https://user-images.githubusercontent.com/69948118/179380695-1d1d4625-3066-44b4-993b-6e483a5711b4.png)
![image](https://user-images.githubusercontent.com/69948118/179380700-fd861e83-d53f-4fc5-8a6b-53e0d3dd7aba.png)
![image](https://user-images.githubusercontent.com/69948118/179380703-99e4b270-527e-407b-a22a-a55cfac7d10b.png)
![image](https://user-images.githubusercontent.com/69948118/179380710-ebc34ea7-8795-4978-aff9-995016fec763.png)
![image](https://user-images.githubusercontent.com/69948118/179380717-05ac42bb-9079-4957-a03a-e9ed1e61a4a0.png)
![image](https://user-images.githubusercontent.com/69948118/179380728-9c10ec7a-4536-4252-9877-6078b382c65b.png)
![image](https://user-images.githubusercontent.com/69948118/179380749-c232387f-43b7-447e-8844-e54492c1d939.png)
![image](https://user-images.githubusercontent.com/69948118/179380760-37d7f141-25aa-4aa7-9c20-383c56ffc56c.png)


### Structure of JWT
![image](https://user-images.githubusercontent.com/69948118/179380778-a99151a1-ce2f-4640-ac9b-23854e3528ba.png)
![image](https://user-images.githubusercontent.com/69948118/179380790-df474a4e-760c-496f-8fde-e12d47c53e66.png)
![image](https://user-images.githubusercontent.com/69948118/179380796-02437a33-d763-4c74-a10f-9ba2b15c6697.png)
![image](https://user-images.githubusercontent.com/69948118/179380813-99a1389f-fb3a-489a-b81b-f373ca480ed1.png)
- jwt.io
![image](https://user-images.githubusercontent.com/69948118/179380840-44fbddb6-eafe-4d96-bd8f-d9ec292d2fb1.png)
![image](https://user-images.githubusercontent.com/69948118/179381047-4f56072d-1312-4ba1-9994-ed319f80366a.png)
![image](https://user-images.githubusercontent.com/69948118/179381062-c00248fa-8f12-4620-8db8-80cf3053eca7.png)
![image](https://user-images.githubusercontent.com/69948118/179381063-e43c27be-1057-4f59-8387-72f06cb88d99.png)
![image](https://user-images.githubusercontent.com/69948118/179381065-ff43a069-8ed1-4a03-aaea-c60899470f78.png)
![image](https://user-images.githubusercontent.com/69948118/179381066-eb689825-d86a-4ae3-b705-b004a7d22903.png)
![image](https://user-images.githubusercontent.com/69948118/179381068-c3f766b3-fc73-4a63-939d-5e5b50b3bec2.png)
![image](https://user-images.githubusercontent.com/69948118/179381074-bf1e4668-2220-489a-b578-1d674ae1d301.png)
![image](https://user-images.githubusercontent.com/69948118/179381084-f6ba63eb-0c67-4275-975f-9891fd1b8c1d.png)
![image](https://user-images.githubusercontent.com/69948118/179381095-16722ff6-4062-4a1d-9216-bfafe1d5566f.png)
![image](https://user-images.githubusercontent.com/69948118/179381098-7868a53f-6afd-4967-8723-1e92ab36f2db.png)
![image](https://user-images.githubusercontent.com/69948118/179381127-654db434-a192-46aa-92fe-2286b6f63967.png)


### Spring Boot+ Spring Security + JWT
![image](https://user-images.githubusercontent.com/69948118/179382174-8506c268-08ad-4b3b-b497-9121a79d5a62.png)
![image](https://user-images.githubusercontent.com/69948118/179382175-8e8b72ae-5ed8-4c09-855d-1719df299268.png)
![image](https://user-images.githubusercontent.com/69948118/179382185-59e31958-49d2-448e-a032-8f26920e0d9c.png)
![image](https://user-images.githubusercontent.com/69948118/179382358-0d17b860-3ebb-40b7-822e-6fa6976be44a.png)
![image](https://user-images.githubusercontent.com/69948118/179382506-a1e540e2-07cc-44a2-81f4-9a4c24ba55d7.png)
![image](https://user-images.githubusercontent.com/69948118/179382857-7698de6f-5b34-4a67-a96d-7fdc79a45b6a.png)

#### /src/main/java/io/javabrains/springsecurityjwt/SpringSecurityJwtApplication.java 

```java
package io.javabrains.springsecurityjwt;

import io.javabrains.springsecurityjwt.filters.JwtRequestFilter;
import io.javabrains.springsecurityjwt.models.AuthenticationRequest;
import io.javabrains.springsecurityjwt.models.AuthenticationResponse;
import io.javabrains.springsecurityjwt.util.JwtUtil;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import org.springframework.http.ResponseEntity;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.BadCredentialsException;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.password.NoOpPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

@SpringBootApplication
public class SpringSecurityJwtApplication {

	public static void main(String[] args) {
		SpringApplication.run(SpringSecurityJwtApplication.class, args);
	}

}

@RestController
class HelloWorldController {

	@Autowired
	private AuthenticationManager authenticationManager;

	@Autowired
	private JwtUtil jwtTokenUtil;

	@Autowired
	private MyUserDetailsService userDetailsService;

	@RequestMapping({ "/hello" })
	public String firstPage() {
		return "Hello World";
	}

	@RequestMapping(value = "/authenticate", method = RequestMethod.POST)
	public ResponseEntity<?> createAuthenticationToken(@RequestBody AuthenticationRequest authenticationRequest) throws Exception {

		try {
			authenticationManager.authenticate(
					new UsernamePasswordAuthenticationToken(authenticationRequest.getUsername(), authenticationRequest.getPassword())
			);
		}
		catch (BadCredentialsException e) {
			throw new Exception("Incorrect username or password", e);
		}


		final UserDetails userDetails = userDetailsService
				.loadUserByUsername(authenticationRequest.getUsername());

		final String jwt = jwtTokenUtil.generateToken(userDetails);

		return ResponseEntity.ok(new AuthenticationResponse(jwt));
	}

}

@EnableWebSecurity
class WebSecurityConfig extends WebSecurityConfigurerAdapter {
	@Autowired
	private UserDetailsService myUserDetailsService;
	@Autowired
	private JwtRequestFilter jwtRequestFilter;

	@Autowired
	public void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {
		auth.userDetailsService(myUserDetailsService);
	}

	@Bean
	public PasswordEncoder passwordEncoder() {
		return NoOpPasswordEncoder.getInstance();
	}

	@Override
	@Bean
	public AuthenticationManager authenticationManagerBean() throws Exception {
		return super.authenticationManagerBean();
	}

	@Override
	protected void configure(HttpSecurity httpSecurity) throws Exception {
		httpSecurity.csrf().disable()
				.authorizeRequests().antMatchers("/authenticate").permitAll().
						anyRequest().authenticated().and().
						exceptionHandling().and().sessionManagement()
				.sessionCreationPolicy(SessionCreationPolicy.STATELESS);
		httpSecurity.addFilterBefore(jwtRequestFilter, UsernamePasswordAuthenticationFilter.class);

	}

}
```


####  /src/main/java/io/javabrains/springsecurityjwt/MyUserDetailsService.java 

```java
package io.javabrains.springsecurityjwt;

import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Service;

import java.util.ArrayList;

@Service
public class MyUserDetailsService implements UserDetailsService {

    @Override
    public UserDetails loadUserByUsername(String s) throws UsernameNotFoundException {
        return new User("foo", "foo",
                new ArrayList<>());
    }
}
```

####  /src/main/java/io/javabrains/springsecurityjwt/util/JwtUtil.java 

```java
package io.javabrains.springsecurityjwt.util;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.stereotype.Service;

import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import java.util.function.Function;

@Service
public class JwtUtil {

    private String SECRET_KEY = "secret";

    public String extractUsername(String token) {
        return extractClaim(token, Claims::getSubject);
    }

    public Date extractExpiration(String token) {
        return extractClaim(token, Claims::getExpiration);
    }

    public <T> T extractClaim(String token, Function<Claims, T> claimsResolver) {
        final Claims claims = extractAllClaims(token);
        return claimsResolver.apply(claims);
    }
    private Claims extractAllClaims(String token) {
        return Jwts.parser().setSigningKey(SECRET_KEY).parseClaimsJws(token).getBody();
    }

    private Boolean isTokenExpired(String token) {
        return extractExpiration(token).before(new Date());
    }

    public String generateToken(UserDetails userDetails) {
        Map<String, Object> claims = new HashMap<>();
        return createToken(claims, userDetails.getUsername());
    }

    private String createToken(Map<String, Object> claims, String subject) {

        return Jwts.builder().setClaims(claims).setSubject(subject).setIssuedAt(new Date(System.currentTimeMillis()))
                .setExpiration(new Date(System.currentTimeMillis() + 1000 * 60 * 60 * 10))
                .signWith(SignatureAlgorithm.HS256, SECRET_KEY).compact();
    }

    public Boolean validateToken(String token, UserDetails userDetails) {
        final String username = extractUsername(token);
        return (username.equals(userDetails.getUsername()) && !isTokenExpired(token));
    }
}
```

####  /src/main/java/io/javabrains/springsecurityjwt/models/AuthenticationRequest.java 

```java
package io.javabrains.springsecurityjwt.models;

import java.io.Serializable;

public class AuthenticationRequest implements Serializable {


    private String username;
    private String password;

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    //need default constructor for JSON Parsing
    public AuthenticationRequest()
    {

    }

    public AuthenticationRequest(String username, String password) {
        this.setUsername(username);
        this.setPassword(password);
    }
}
```

####  /src/main/java/io/javabrains/springsecurityjwt/models/AuthenticationResponse.java

```java
package io.javabrains.springsecurityjwt.models;

import java.io.Serializable;

public class AuthenticationResponse implements Serializable {

    private final String jwt;

    public AuthenticationResponse(String jwt) {
        this.jwt = jwt;
    }

    public String getJwt() {
        return jwt;
    }
}
```


####  /src/main/java/io/javabrains/springsecurityjwt/filters/JwtRequestFilter.java 

```java
package io.javabrains.springsecurityjwt.filters;

import io.javabrains.springsecurityjwt.MyUserDetailsService;
import io.javabrains.springsecurityjwt.util.JwtUtil;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.web.authentication.WebAuthenticationDetailsSource;
import org.springframework.stereotype.Component;
import org.springframework.web.filter.OncePerRequestFilter;

import javax.servlet.FilterChain;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@Component
public class JwtRequestFilter extends OncePerRequestFilter {

    @Autowired
    private MyUserDetailsService userDetailsService;

    @Autowired
    private JwtUtil jwtUtil;

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain)
            throws ServletException, IOException {

        final String authorizationHeader = request.getHeader("Authorization");

        String username = null;
        String jwt = null;

        if (authorizationHeader != null && authorizationHeader.startsWith("Bearer ")) {
            jwt = authorizationHeader.substring(7);
            username = jwtUtil.extractUsername(jwt);
        }


        if (username != null && SecurityContextHolder.getContext().getAuthentication() == null) {

            UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);

            if (jwtUtil.validateToken(jwt, userDetails)) {

                UsernamePasswordAuthenticationToken usernamePasswordAuthenticationToken = new UsernamePasswordAuthenticationToken(
                        userDetails, null, userDetails.getAuthorities());
                usernamePasswordAuthenticationToken
                        .setDetails(new WebAuthenticationDetailsSource().buildDetails(request));
                SecurityContextHolder.getContext().setAuthentication(usernamePasswordAuthenticationToken);
            }
        }
        chain.doFilter(request, response);
    }

}
```

### Oath
![image](https://user-images.githubusercontent.com/69948118/179384883-49ab6543-4360-4de4-ba3e-2aa2dc5eedae.png)
![image](https://user-images.githubusercontent.com/69948118/179384904-242f8c8a-8b4b-48a8-a751-3c01ff04772a.png)
![image](https://user-images.githubusercontent.com/69948118/179384909-05de316c-7e4c-4c55-ba53-9a2fd72993b7.png)
![image](https://user-images.githubusercontent.com/69948118/179384915-98203694-a31d-4e96-9922-4921fefd028a.png)
![image](https://user-images.githubusercontent.com/69948118/179384962-4ef985e3-8737-44eb-a572-705acf43cbb1.png)
![image](https://user-images.githubusercontent.com/69948118/179384966-865a73b4-863e-4ccc-ad0d-3e5f3a51f962.png)
![image](https://user-images.githubusercontent.com/69948118/179384980-d4b8f16f-1351-4b41-a467-70475e16c410.png)
![image](https://user-images.githubusercontent.com/69948118/179384984-317ebe6e-73ac-49de-837a-710436f95fc4.png)
![image](https://user-images.githubusercontent.com/69948118/179384995-a264c93c-6750-4de7-b4eb-6501786712b8.png)
![image](https://user-images.githubusercontent.com/69948118/179385003-d12d34e6-1c3e-4540-b15e-107016b1224d.png)
![image](https://user-images.githubusercontent.com/69948118/179385011-b51baa1e-c7c4-4839-9722-ae169b448e60.png)
![image](https://user-images.githubusercontent.com/69948118/179385013-8aa203f7-21ec-4589-88b5-821408d02833.png)
![image](https://user-images.githubusercontent.com/69948118/179385018-30f11de5-1375-4931-8283-3d8700e9f5bf.png)
![image](https://user-images.githubusercontent.com/69948118/179385020-9be5fdc0-4685-4c22-aa70-8adaa16bae4a.png)
![image](https://user-images.githubusercontent.com/69948118/179385028-6bbf6be6-8a0c-4ff4-b134-d5c6b961e966.png)
![image](https://user-images.githubusercontent.com/69948118/179385057-7ef7d3f6-1486-48e4-a5cb-0196fdb30cd6.png)
![image](https://user-images.githubusercontent.com/69948118/179385072-c9f1c29f-d479-4d27-98ee-dbdccfad2f89.png)
![image](https://user-images.githubusercontent.com/69948118/179385073-fb0a2ba9-4d2b-425e-96eb-c190e21910bc.png)
![image](https://user-images.githubusercontent.com/69948118/179385082-f675a841-8666-4ba0-87f4-3a1ce15d7619.png)
![image](https://user-images.githubusercontent.com/69948118/179385086-146fc839-09fe-4605-aa07-2dbeb82fd2db.png)
![image](https://user-images.githubusercontent.com/69948118/179385097-14034c9e-1a69-48ae-8734-7efb08617d8a.png)
![image](https://user-images.githubusercontent.com/69948118/179385102-25b7443e-81f9-4a37-bdb4-71f337e58dd4.png)


### Oauth Terminologies
![image](https://user-images.githubusercontent.com/69948118/179385135-98f413a4-0a5a-4f51-ba2b-cd202bc92f8b.png)
![image](https://user-images.githubusercontent.com/69948118/179385149-940c847e-f2e2-4aa1-a24a-bb24ac479893.png)
![image](https://user-images.githubusercontent.com/69948118/179385178-782f49fe-ebe7-43c5-9a00-82ce8f78c5fd.png)
![image](https://user-images.githubusercontent.com/69948118/179385201-f96dc700-fc26-44f6-be5a-ec85c1f59397.png)
![image](https://user-images.githubusercontent.com/69948118/179385218-992b432d-a8ba-412a-832a-1162ba37a2aa.png)
![image](https://user-images.githubusercontent.com/69948118/179385235-3e2f533a-5c50-44a6-bb45-52d42ed1e897.png)
![image](https://user-images.githubusercontent.com/69948118/179385253-ef8e05c2-1c60-4465-905d-3d2a8c8d3907.png)
![image](https://user-images.githubusercontent.com/69948118/179385274-2ddd7cd5-0071-4dc7-9ee2-9318cd4ed076.png)
![image](https://user-images.githubusercontent.com/69948118/179385291-71e2966d-3d41-4d6d-8cb1-23a7a3ee6de9.png)
![image](https://user-images.githubusercontent.com/69948118/179385312-6d5d9b92-98e2-4042-aa0b-86b7a2c71ab9.png)
![image](https://user-images.githubusercontent.com/69948118/179385349-997479e8-e5ee-4758-b030-506f5c6490be.png)
![image](https://user-images.githubusercontent.com/69948118/179385386-d29a7d5a-f1f1-4972-80ea-e33624eead51.png)
![image](https://user-images.githubusercontent.com/69948118/179385389-063132f3-4afa-478f-a249-fec55284c6ba.png)
![image](https://user-images.githubusercontent.com/69948118/179385405-69281009-587e-4b1c-91a3-9ea3f14a5627.png)
![image](https://user-images.githubusercontent.com/69948118/179385420-f7db3135-1360-4568-a6f5-8b5fd8c02d20.png)
![image](https://user-images.githubusercontent.com/69948118/179385426-c8b1f1e5-849d-431f-852c-96d9b8b9cce2.png)
![image](https://user-images.githubusercontent.com/69948118/179385438-395299c5-3063-4c1f-8f2d-9f5eb7a67d73.png)
![image](https://user-images.githubusercontent.com/69948118/179385444-e7e0b9dd-544e-4ae2-b578-48d6701b18e6.png)
![image](https://user-images.githubusercontent.com/69948118/179385477-c98c4c7a-4615-461e-b74f-6d7d0a2c2b55.png)
![image](https://user-images.githubusercontent.com/69948118/179385484-745c3fc3-2dd2-4a6c-a9c3-b08bd6c13e16.png)
![image](https://user-images.githubusercontent.com/69948118/179385508-05ad08aa-9a2f-4c67-9544-f4fbe100f72d.png)
![image](https://user-images.githubusercontent.com/69948118/179385517-ae61507a-7391-4de9-be13-4f36af222f0e.png)
![image](https://user-images.githubusercontent.com/69948118/179385521-a2829ac9-5e2c-405c-ae75-96a48c419946.png)
![image](https://user-images.githubusercontent.com/69948118/179385524-05bf67e7-8706-488c-bac1-4305577ae17b.png)
![image](https://user-images.githubusercontent.com/69948118/179385531-99d6c19c-42cf-4145-8f1d-a77c1671cc97.png)
![image](https://user-images.githubusercontent.com/69948118/179385563-cad9fed1-0aec-4c9f-97b3-1bea875a678d.png)
![image](https://user-images.githubusercontent.com/69948118/179385569-99fc755a-a4e2-460b-949d-1f8d617e11e6.png)
![image](https://user-images.githubusercontent.com/69948118/179385576-345c63ee-48c5-4590-a149-a3c391df2611.png)
![image](https://user-images.githubusercontent.com/69948118/179385637-8cef3dd0-bd9c-4bf7-88c2-9aedc1eb4163.png)
![image](https://user-images.githubusercontent.com/69948118/179385683-124aee42-5a03-4632-a674-cdadfe6d63eb.png)
![image](https://user-images.githubusercontent.com/69948118/179385700-7cf8c7f0-aeee-4d7f-8f05-66c980e7d17a.png)
![image](https://user-images.githubusercontent.com/69948118/179385730-81c2ed41-2156-4348-a0c0-d8b2d7bfdbae.png)
![image](https://user-images.githubusercontent.com/69948118/179385755-1bf4bfba-0dd2-4017-ae85-1a02c51daeda.png)
![image](https://user-images.githubusercontent.com/69948118/179385760-852cb265-90f7-4069-964e-799d41cacfe4.png)
![image](https://user-images.githubusercontent.com/69948118/179385764-3376888b-cd8d-4a13-9c52-a345b9fb9157.png)

### Implementing login with Facebook and Github

![image](https://user-images.githubusercontent.com/69948118/179385876-ba7f6c78-756f-4997-8daa-43ce2bd17a9c.png)
![image](https://user-images.githubusercontent.com/69948118/179386040-ac2bc6b8-fff7-41d8-a97a-858a7947bc83.png)
![image](https://user-images.githubusercontent.com/69948118/179386133-b296450a-19d0-4211-a783-eacc06e046ec.png)
![image](https://user-images.githubusercontent.com/69948118/179386144-351cc965-04be-48e4-b0c3-878b1acff58d.png)
![image](https://user-images.githubusercontent.com/69948118/179386215-3878418b-d936-4257-9123-40971ce0caf9.png)
![image](https://user-images.githubusercontent.com/69948118/179386224-06b98906-a342-40a1-8f87-2fedbfbb75cd.png)
![image](https://user-images.githubusercontent.com/69948118/179386234-2dc50a1a-822d-4120-b2e6-736a0b32fad3.png)
![image](https://user-images.githubusercontent.com/69948118/179386304-c5613fec-6a96-40e8-8d8c-8f758e200e8c.png)
![image](https://user-images.githubusercontent.com/69948118/179386360-3acb73cb-81c7-45bc-b3c3-eedbd21fdfff.png)
![image](https://user-images.githubusercontent.com/69948118/179386395-9e4d4c6b-cb64-4e33-9231-5b0ca05f5bb1.png)
![image](https://user-images.githubusercontent.com/69948118/179386415-0cf22df6-65af-42a9-bcd1-44bbafff2f29.png)
![image](https://user-images.githubusercontent.com/69948118/179386429-96ebd286-2c98-4f54-a239-fcd64cfb47ef.png)








































