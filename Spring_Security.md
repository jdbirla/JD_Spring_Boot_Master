## Java Brains
- src: https://www.youtube.com/results?search_query=spring+security+in+spring+boot
- Github: src: https://github.com/koushikkothagal/spring-boot-security/tree/master/src/main/java/io/javabrains/springbootsecurity
- JPA: https://github.com/koushikkothagal/spring-security-jpa

![image](https://user-images.githubusercontent.com/69948118/179373350-658da467-2556-4669-b297-a5c225bbacfc.png)
![image](https://user-images.githubusercontent.com/69948118/179373355-cdcc8393-8863-422d-a469-b59bba39269a.png)
![image](https://user-images.githubusercontent.com/69948118/179373388-db8b1c11-dc5f-4f35-8b90-c4d3e53bfd6c.png)
![image](https://user-images.githubusercontent.com/69948118/179373394-01da91dd-b7f4-487c-b78a-b57d49fad231.png)
![image](https://user-images.githubusercontent.com/69948118/179373406-8d84d2cb-9267-48db-9dea-1bfabba04de8.png)
![image](https://user-images.githubusercontent.com/69948118/179373419-8c1bbdb9-4277-4fb3-980b-b1604a164968.png)
![image](https://user-images.githubusercontent.com/69948118/179373426-da57d4e3-6c3d-4e77-85ac-73b43138a1bc.png)
![image](https://user-images.githubusercontent.com/69948118/179373465-ee087a69-da9e-4b74-971b-d53df8732cbd.png)
![image](https://user-images.githubusercontent.com/69948118/179373479-96e9f54f-4fa1-4b8d-8b63-dcb4bf2c133e.png)

![image](https://user-images.githubusercontent.com/69948118/179373536-e53cb04d-bb0d-42cd-8567-91069b01e3ea.png)
![image](https://user-images.githubusercontent.com/69948118/179373542-679e5a09-348a-469b-8c11-dd498746e65e.png)
![image](https://user-images.githubusercontent.com/69948118/179373555-6a3e3656-e7e3-4f8b-b4bd-1d211eb6bc6a.png)
![image](https://user-images.githubusercontent.com/69948118/179373564-85a0e71c-2122-4f12-90a6-6de618b084c8.png)
![image](https://user-images.githubusercontent.com/69948118/179373566-c44e6c70-2b35-4a34-80f3-4fdbd331e10c.png)
![image](https://user-images.githubusercontent.com/69948118/179373584-2e0227b9-7812-41cd-a637-6652627178ff.png)
![image](https://user-images.githubusercontent.com/69948118/179373588-993101b7-dc27-4516-ae58-31bd879e43d5.png)
![image](https://user-images.githubusercontent.com/69948118/179373598-3521183f-94ee-48cb-8cd2-8c0c7b69c66c.png)
![image](https://user-images.githubusercontent.com/69948118/179373602-b249b934-e077-4e2f-a46c-558cb2f49a03.png)
![image](https://user-images.githubusercontent.com/69948118/179373612-33e0b6ad-0541-49e7-ba2c-11ec934b9766.png)
![image](https://user-images.githubusercontent.com/69948118/179373619-1e5f3c4b-7192-42a5-9e0c-99a8c39cbbce.png)
![image](https://user-images.githubusercontent.com/69948118/179373634-f3bd3a66-0507-4da2-a9ec-367395a56634.png)
![image](https://user-images.githubusercontent.com/69948118/179373648-91973b9e-d1d1-4408-8ecd-ebfa6cda4eaf.png)
![image](https://user-images.githubusercontent.com/69948118/179373649-76ae07f5-83c8-46eb-aa14-2630a7c8aeb9.png)
![image](https://user-images.githubusercontent.com/69948118/179373661-6ac2bcde-ae68-41d0-bb2d-673fbc41dfa8.png)
![image](https://user-images.githubusercontent.com/69948118/179373666-d5454a3a-f41d-49da-aa7c-7562ffbe6704.png)
![image](https://user-images.githubusercontent.com/69948118/179373670-b77194f0-4589-4f82-acc7-2519e47e8618.png)
![image](https://user-images.githubusercontent.com/69948118/179373676-6b55125e-9a5d-47a7-b033-39ba97847be4.png)
### Adding Spring Secutry to new spring boot project
![image](https://user-images.githubusercontent.com/69948118/179373716-7871a3a8-2732-414d-9afc-de1055dc8aa2.png)
![image](https://user-images.githubusercontent.com/69948118/179373722-3db1b017-04a3-46d9-9e59-87b49391e3e5.png)
![image](https://user-images.githubusercontent.com/69948118/179373739-41fea297-5e9c-4003-913e-4ed9bb3d83c9.png)
![image](https://user-images.githubusercontent.com/69948118/179373755-847e74e4-9f4a-4fbb-992b-0fa351422365.png)
![image](https://user-images.githubusercontent.com/69948118/179373784-81f0d968-9ae8-4903-80c5-f5397f0f470e.png)
![image](https://user-images.githubusercontent.com/69948118/179373815-47ab853b-1681-470c-96c3-0cdcb7af5078.png)
![image](https://user-images.githubusercontent.com/69948118/179373852-9914db39-96e9-4635-8ae8-19558e8436f3.png)
![image](https://user-images.githubusercontent.com/69948118/179373886-15c91993-0654-4266-9157-7b172ac47686.png)
### How to configure spring security authentication
![image](https://user-images.githubusercontent.com/69948118/179373913-28dcc4fe-0858-4cb3-9a33-e4afc9a5a12d.png)
![image](https://user-images.githubusercontent.com/69948118/179373921-466d463d-c179-4a1e-9484-7f92c88645bf.png)
![image](https://user-images.githubusercontent.com/69948118/179373939-bea9aa01-c463-4940-8267-60637ba1331b.png)
![image](https://user-images.githubusercontent.com/69948118/179373970-e2a9e534-a36a-4554-b559-b6c9fa433c29.png)
![image](https://user-images.githubusercontent.com/69948118/179373979-21c2c78f-383d-4eee-9ce9-1611d0af26a0.png)
![image](https://user-images.githubusercontent.com/69948118/179373986-e6d8ff41-7c70-4566-a06b-2afe100d81cb.png)
![image](https://user-images.githubusercontent.com/69948118/179374010-587c9c33-7b4d-4955-b46d-0bbf1a5a6740.png)
![image](https://user-images.githubusercontent.com/69948118/179374151-df108ae7-0193-48c1-8082-d852d65cdc2f.png)
![image](https://user-images.githubusercontent.com/69948118/179374231-1750e27f-7982-4791-9863-26d449b520eb.png)
![image](https://user-images.githubusercontent.com/69948118/179374240-cdd6294f-29ea-44d1-b792-25c4f7f0c99a.png)
### How to configure spring security authorization
![image](https://user-images.githubusercontent.com/69948118/179374323-4a740989-14f1-4f1c-8159-beec06a00835.png)
![image](https://user-images.githubusercontent.com/69948118/179374339-efe6cfe2-207d-4774-8326-0a206f322639.png)
![image](https://user-images.githubusercontent.com/69948118/179374365-47028f1b-6267-4d44-899a-77132c749dcb.png)
![image](https://user-images.githubusercontent.com/69948118/179374380-d2bac45e-9d8f-40a5-b808-e206255dc2cd.png)
![image](https://user-images.githubusercontent.com/69948118/179374438-9abd3358-d5ea-4bdb-895b-c47d73369a97.png)
![image](https://user-images.githubusercontent.com/69948118/179374441-1409ee68-f8b4-4f25-8324-9afb2a66797e.png)
![image](https://user-images.githubusercontent.com/69948118/179374624-1eac1e0f-55c4-4c5b-9903-94082c66e04f.png)


#### src/main/java/io/javabrains/springbootsecurity/HomeResource.java
```java
package io.javabrains.springbootsecurity;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HomeResource {

    @GetMapping("/")
    public String home() {
        return ("<h1>Welcome</h1>");
    }

    @GetMapping("/user")
    public String user() {
        return ("<h1>Welcome User</h1>");
    }

    @GetMapping("/admin")
    public String admin() {
        return ("<h1>Welcome Admin</h1>");
    }
}
```
#### src/main/java/io/javabrains/springbootsecurity/SecurityConfiguration.java
```java
package io.javabrains.springbootsecurity;

import org.springframework.context.annotation.Bean;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.crypto.password.NoOpPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;

@EnableWebSecurity
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {
    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        // Set your configuration on the auth object
        auth.inMemoryAuthentication()
                .withUser("blah")
                .password("blah")
                .roles("USER")
                .and()
                .withUser("foo")
                .password("foo")
                .roles("ADMIN");
    }

    @Bean
    public PasswordEncoder getPasswordEncoder() {
        return NoOpPasswordEncoder.getInstance();
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
                .antMatchers("/admin").hasRole("ADMIN")
                .antMatchers("/user").hasAnyRole("ADMIN", "USER")
                .antMatchers("/").permitAll()
                .and().formLogin();
    }
}
```
### How Spring security works
![image](https://user-images.githubusercontent.com/69948118/179374905-e80ce0f7-7a37-412e-8667-5e0faf942785.png)
![image](https://user-images.githubusercontent.com/69948118/179374925-76608058-7b86-4a34-9134-514f22b3ba86.png)
![image](https://user-images.githubusercontent.com/69948118/179374949-ef3f0fee-54a6-43e7-befb-ed9572d76719.png)
![image](https://user-images.githubusercontent.com/69948118/179374963-f3b3ec4d-b84a-4535-83bc-5976f18f4deb.png)
![image](https://user-images.githubusercontent.com/69948118/179375041-c353542d-cf7b-4355-b48c-88bc5ba0d8a0.png)
![image](https://user-images.githubusercontent.com/69948118/179375051-e597f242-e3ab-4633-a461-c2cce6542cca.png)
![image](https://user-images.githubusercontent.com/69948118/179375059-f3141a80-ea17-4cf0-879d-84134f3b0d56.png)
![image](https://user-images.githubusercontent.com/69948118/179375075-457babac-7212-44ed-a290-db94eb745d98.png)
![image](https://user-images.githubusercontent.com/69948118/179375084-ab733b05-90e2-4fba-8719-163fdbfbe794.png)
![image](https://user-images.githubusercontent.com/69948118/179375097-27933f5f-8ce8-425b-b443-2d1589cf40c6.png)
![image](https://user-images.githubusercontent.com/69948118/179375137-6fb9edc4-66ed-4f5d-8d2b-05122ae577bb.png)
![image](https://user-images.githubusercontent.com/69948118/179375165-9e975ec0-8ba3-4133-a217-3b09e4a87c79.png)
![image](https://user-images.githubusercontent.com/69948118/179375178-ef5b69f6-4e2a-4793-9947-acdf67485376.png)
![image](https://user-images.githubusercontent.com/69948118/179375182-25853337-9d2e-4f62-aa84-2aad997b0a7e.png)
![image](https://user-images.githubusercontent.com/69948118/179375214-6118fa14-ec53-43fb-aee6-6e4abcbe9fcb.png)
![image](https://user-images.githubusercontent.com/69948118/179375229-b1154601-4e42-4062-b1d2-fbe9cbbec3f5.png)
![image](https://user-images.githubusercontent.com/69948118/179375234-1169d68c-4f4c-42a5-aade-87494e41d4c6.png)
![image](https://user-images.githubusercontent.com/69948118/179375262-df37ae01-3714-4d91-bb5c-16d7966e0782.png)

### JDBC Authentication 
![image](https://user-images.githubusercontent.com/69948118/179375292-43d4a94b-e212-4ede-9367-58a7d305eb10.png)
![image](https://user-images.githubusercontent.com/69948118/179375359-b3cfe9ad-ab33-4c3c-9467-7a652aa6bd4b.png)
![image](https://user-images.githubusercontent.com/69948118/179375699-0481bbbc-090d-42d5-9271-9b0b4648b075.png)
![image](https://user-images.githubusercontent.com/69948118/179375701-d7ad7225-f51a-43bc-9a16-fa8afc5ac3b1.png)
![image](https://user-images.githubusercontent.com/69948118/179375871-3aaef171-f5d0-4854-a6b3-1b2ad8fdeef3.png)
![image](https://user-images.githubusercontent.com/69948118/179375892-1cd008fc-c5e9-48af-b647-e5815d62a098.png)
![image](https://user-images.githubusercontent.com/69948118/179375918-a8d83111-0ea7-4795-a60b-37f077d92e4e.png)
![image](https://user-images.githubusercontent.com/69948118/179376219-a615eb39-95f2-49d8-b409-e1f05b0609f2.png)
![image](https://user-images.githubusercontent.com/69948118/179376558-4adb581e-2feb-4c14-8a55-577106e495f2.png)

### Spring Boot + Spring Security with JPA authentication and MySql

![image](https://user-images.githubusercontent.com/69948118/179377461-c2ed9bdd-8731-49c6-bc71-ded0058c63c9.png)
![image](https://user-images.githubusercontent.com/69948118/179377511-9e38b46f-68c7-49a8-b18f-8d6af5e01c42.png)
![image](https://user-images.githubusercontent.com/69948118/179377989-a806c5c6-7a7f-4e12-809b-0d8f9527cba2.png)
![image](https://user-images.githubusercontent.com/69948118/179378934-f1f9e7d4-f768-4d1d-85fe-39df89e7865b.png)
![image](https://user-images.githubusercontent.com/69948118/179379227-11b6c0a1-27fd-427f-aef8-805b7ea54a26.png)
![image](https://user-images.githubusercontent.com/69948118/179379429-d85722ab-9fd0-4f04-ad7e-bda7638a5692.png)
![image](https://user-images.githubusercontent.com/69948118/179379432-f590bad9-a39c-4b26-aac7-b2890f9c8e19.png)

#### /src/main/resources/application.properties
```properties
spring.datasource.url=jdbc:mysql://localhost:3306/springsecurity
spring.datasource.username=root
spring.datasource.password =password
spring.jpa.hibernate.ddl-auto=update
spring.jpa.hibernate.naming-strategy=org.hibernate.cfg.ImprovedNamingStrategy
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5Dialect
```
#### src/main/java/io/javabrains/springsecurityjpa/models/MyUserDetails.java

```java
package io.javabrains.springsecurityjpa.models;

import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;

import java.util.Arrays;
import java.util.Collection;
import java.util.List;
import java.util.stream.Collectors;

public class MyUserDetails implements UserDetails {

    private String userName;
    private String password;
    private boolean active;
    private List<GrantedAuthority> authorities;

    public MyUserDetails(User user) {
        this.userName = user.getUserName();
        this.password = user.getPassword();
        this.active = user.isActive();
        this.authorities = Arrays.stream(user.getRoles().split(","))
                    .map(SimpleGrantedAuthority::new)
                    .collect(Collectors.toList());
    }

    @Override
    public Collection<? extends GrantedAuthority> getAuthorities() {
        return authorities;
    }

    @Override
    public String getPassword() {
        return password;
    }

    @Override
    public String getUsername() {
        return userName;
    }

    @Override
    public boolean isAccountNonExpired() {
        return true;
    }

    @Override
    public boolean isAccountNonLocked() {
        return true;
    }

    @Override
    public boolean isCredentialsNonExpired() {
        return true;
    }

    @Override
    public boolean isEnabled() {
        return active;
    }
}
```
#### /src/main/java/io/javabrains/springsecurityjpa/models/User.java 

```java
package io.javabrains.springsecurityjpa.models;

import javax.persistence.*;

@Entity
@Table(name = "User")
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private int id;
    private String userName;
    private String password;
    private boolean active;
    private String roles;

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public boolean isActive() {
        return active;
    }

    public void setActive(boolean active) {
        this.active = active;
    }

    public String getRoles() {
        return roles;
    }

    public void setRoles(String roles) {
        this.roles = roles;
    }
}
```
#### /src/main/java/io/javabrains/springsecurityjpa/HomeResource.java 

```java
package io.javabrains.springsecurityjpa;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HomeResource {

    @GetMapping("/")
    public String home() {
        return ("<h1>Welcome</h1>");
    }

    @GetMapping("/user")
    public String user() {
        return ("<h1>Welcome User</h1>");
    }

    @GetMapping("/admin")
    public String admin() {
        return ("<h1>Welcome Admin</h1>");
    }
}

```
#### /src/main/java/io/javabrains/springsecurityjpa/MyUserDetailsService.java 

```java
package io.javabrains.springsecurityjpa;

import io.javabrains.springsecurityjpa.models.MyUserDetails;

import io.javabrains.springsecurityjpa.models.User;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class MyUserDetailsService implements UserDetailsService {

    @Autowired
    UserRepository userRepository;

    @Override
    public UserDetails loadUserByUsername(String userName) throws UsernameNotFoundException {
        Optional<User> user = userRepository.findByUserName(userName);

        user.orElseThrow(() -> new UsernameNotFoundException("Not found: " + userName));

        return user.map(MyUserDetails::new).get();
    }
}
```

### /src/main/java/io/javabrains/springsecurityjpa/SecurityConfiguration.java
```java
package io.javabrains.springsecurityjpa;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.password.NoOpPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;

@EnableWebSecurity
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

    @Autowired
    UserDetailsService userDetailsService;

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth.userDetailsService(userDetailsService);
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
                .antMatchers("/admin").hasRole("ADMIN")
                .antMatchers("/user").hasAnyRole("ADMIN", "USER")
                .antMatchers("/").permitAll()
                .and().formLogin();
    }

    @Bean
    public PasswordEncoder getPasswordEncoder() {
        return NoOpPasswordEncoder.getInstance();
    }
}
```

### /src/main/java/io/javabrains/springsecurityjpa/UserRepository.java 
```java
package io.javabrains.springsecurityjpa;

import io.javabrains.springsecurityjpa.models.User;
import org.springframework.data.jpa.repository.JpaRepository;

import java.util.Optional;

public interface UserRepository extends JpaRepository<User, Integer> {
    Optional<User> findByUserName(String userName);
}
```

### /src/main/java/io/javabrains/springsecurityjpa/SpringSecurityJpaApplication.java
```java
package io.javabrains.springsecurityjpa;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;

@SpringBootApplication
@EnableJpaRepositories(basePackageClasses = UserRepository.class)
public class SpringSecurityJpaApplication {

	public static void main(String[] args) {
		SpringApplication.run(SpringSecurityJpaApplication.class, args);
	}

}
```











